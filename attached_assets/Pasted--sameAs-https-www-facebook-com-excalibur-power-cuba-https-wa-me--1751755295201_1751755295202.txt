      "sameAs": [
        "https://www.facebook.com/excalibur.power.cuba",
        "https://wa.me/5355555555"
      ],
      "contactPoint": [
        {
          "@type": "ContactPoint",
          "telephone": "+53-58-78-1416",
          "contactType": "sales",
          "availableLanguage": ["Spanish", "German", "English"]
        },
        {
          "@type": "ContactPoint",
          "telephone": "+49-160-323-9439",
          "contactType": "technical support",
          "availableLanguage": ["German", "English"]
        },
        {
          "@type": "ContactPoint",
          "telephone": "+53-5473-1490",
          "contactType": "customer service",
          "availableLanguage": ["Spanish"]
        }
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Productos Solares y Generadores",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Product",
              "name": "Sistemas Solares Completos",
              "description": "Sistemas solares completos de 1KW a 20KW con garantía internacional"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Product",
              "name": "Paneles Solares",
              "description": "Paneles monocristalinos y policristalinos de 300W a 550W"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Product",
              "name": "Generadores",
              "description": "Generadores diesel y gasolina silenciosos de 2KVA a 10KVA"
            }
          }
        ]
      }
    }
    </script>
    <script type="module" crossorigin src="/assets/index-_NFTae5s.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-BnNToIff.css">
  </head>
  <body>
    <div id="root"></div>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>
root@srv896300:~# curl -v http://localhost
*   Trying 127.0.0.1:80...
* Connected to localhost (127.0.0.1) port 80 (#0)
> GET / HTTP/1.1
> Host: localhost
> User-Agent: curl/7.81.0
> Accept: */*
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
< Server: nginx/1.18.0 (Ubuntu)
< Date: Sat, 05 Jul 2025 22:26:58 GMT
< Content-Type: text/html; charset=UTF-8
< Content-Length: 6807
< Connection: keep-alive
< X-Powered-By: Express
< Accept-Ranges: bytes
< Cache-Control: public, max-age=0
< Last-Modified: Sat, 05 Jul 2025 22:12:48 GMT
< ETag: W/"1a97-197dca631c5"
<
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Excalibur Cuba - Paneles Solares y Generadores | Solar Panels & Generators</title>
    <meta name="description" content="Excalibur Power Cuba - Importador profesional de componentes solares y generadores en Cuba. Sistemas solares completos 1KW-20KW, paneles monocristalinos 300W-550W, inversores híbridos, baterías LiFePO4 y generadores silenciosos 2-10KVA. Mejor calidad al mejor precio con garantía internacional.">
    <meta name="keywords" content="paneles solares Cuba, generadores Cuba, energia solar, componentes solares, inversores hibridos, baterias litio, sistemas solares completos, Excalibur Power, solar Cuba, generadores silenciosos">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Excalibur Power Cuba">
    <meta name="revisit-after" content="7 days">
    <meta name="geo.region" content="CU">
    <meta name="geo.placename" content="Cuba">
    <meta name="geo.position" content="21.521757;-77.781167">
    <meta name="ICBM" content="21.521757, -77.781167">
    <link rel="canonical" href="https://excalibur-cuba.com/">
    <meta name="rating" content="general">
    <meta name="distribution" content="global">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://excalibur-cuba.com/">
    <meta property="og:title" content="Excalibur Cuba - Paneles Solares y Generadores | Sistemas Solares Completos">
    <meta property="og:description" content="Importador profesional de componentes solares y generadores en Cuba. Sistemas solares completos 1KW-20KW, paneles monocristalinos, inversores híbridos, baterías LiFePO4. Mejor calidad al mejor precio con garantía internacional.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1501594907352-04cda38ebc29?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&h=630">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Excalibur Power Cuba">
    <meta property="og:locale" content="es_ES">
    <meta property="og:locale:alternate" content="de_DE">
    <meta property="og:locale:alternate" content="en_US">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://excalibur-cuba.com/">
    <meta property="twitter:title" content="Excalibur Cuba - Paneles Solares y Generadores | Sistemas Solares Completos">
    <meta property="twitter:description" content="Importador profesional de componentes solares y generadores en Cuba. Sistemas solares completos 1KW-20KW, paneles monocristalinos, inversores híbridos, baterías LiFePO4.">
    <meta property="twitter:image" content="https://images.unsplash.com/photo-1501594907352-04cda38ebc29?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&h=630">
    <meta name="twitter:image:alt" content="Instalación de paneles solares - Excalibur Power Cuba">
    <meta name="twitter:site" content="@ExcaliburCuba">
    <meta name="twitter:creator" content="@ExcaliburCuba">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3e%3ccircle cx='16' cy='16' r='14' fill='%23f59e0b'/%3e%3cpath d='M12 8h8v3h-8z' fill='%23fff'/%3e%3cpath d='M10 12h12v2h-12z' fill='%23fff'/%3e%3cpath d='M8 16h16v2h-16z' fill='%23fff'/%3e%3cpath d='M10 20h12v2h-12z' fill='%23fff'/%3e%3cpath d='M12 24h8v1h-8z' fill='%23fff'/%3e%3c/svg%3e">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Excalibur Power Cuba",
      "url": "https://excalibur-cuba.com",
      "logo": "https://excalibur-cuba.com/logo.png",
      "description": "Importador profesional de componentes solares y generadores en Cuba. Sistemas solares completos, paneles monocristalinos, inversores híbridos, baterías LiFePO4 y generadores silenciosos.",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "CU",
        "addressLocality": "Havanna del Este",
        "addressRegion": "La Habana"
      },
      "sameAs": [
        "https://www.facebook.com/excalibur.power.cuba",
        "https://wa.me/5355555555"
      ],
      "contactPoint": [
        {
          "@type": "ContactPoint",
          "telephone": "+53-58-78-1416",
          "contactType": "sales",
          "availableLanguage": ["Spanish", "German", "English"]
        },
        {
          "@type": "ContactPoint",
          "telephone": "+49-160-323-9439",
          "contactType": "technical support",
          "availableLanguage": ["German", "English"]
        },
        {
          "@type": "ContactPoint",
          "telephone": "+53-5473-1490",
          "contactType": "customer service",
          "availableLanguage": ["Spanish"]
        }
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Productos Solares y Generadores",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Product",
              "name": "Sistemas Solares Completos",
              "description": "Sistemas solares completos de 1KW a 20KW con garantía internacional"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Product",
              "name": "Paneles Solares",
              "description": "Paneles monocristalinos y policristalinos de 300W a 550W"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Product",
              "name": "Generadores",
              "description": "Generadores diesel y gasolina silenciosos de 2KVA a 10KVA"
            }
          }
        ]
      }
    }
    </script>
    <script type="module" crossorigin src="/assets/index-_NFTae5s.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-BnNToIff.css">
  </head>
  <body>
    <div id="root"></div>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>
* Connection #0 to host localhost left intact
root@srv896300:~# ufw status
Status: inactive
root@srv896300:~# ufw allow 80
Rules updated
Rules updated (v6)
root@srv896300:~# ufw allow 443
Rules updated
Rules updated (v6)
root@srv896300:~# ufw allow ssh
Rules updated
Rules updated (v6)
root@srv896300:~# ufw --force enable
Firewall is active and enabled on system startup
root@srv896300:~# apt install -y certbot python3-certbot-nginx
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  python3-acme python3-certbot python3-configargparse python3-icu python3-josepy python3-parsedatetime
  python3-requests-toolbelt python3-rfc3339 python3-zope.component python3-zope.event python3-zope.hookable
Suggested packages:
  python-certbot-doc python3-certbot-apache python-acme-doc python-certbot-nginx-doc
The following NEW packages will be installed:
  certbot python3-acme python3-certbot python3-certbot-nginx python3-configargparse python3-icu python3-josepy
  python3-parsedatetime python3-requests-toolbelt python3-rfc3339 python3-zope.component python3-zope.event
  python3-zope.hookable
0 upgraded, 13 newly installed, 0 to remove and 1 not upgraded.
Need to get 993 kB of archives.
After this operation, 5077 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-josepy all 1.10.0-1 [22.0 kB]
Get:2 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-requests-toolbelt all 0.9.1-1 [38.0 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-rfc3339 all 1.1-3 [7110 B]
Get:4 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-acme all 1.21.0-1ubuntu0.1 [36.4 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-configargparse all 1.5.3-1 [26.9 kB]
Get:6 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-parsedatetime all 2.6-2 [32.9 kB]
Get:7 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-zope.hookable amd64 5.1.0-1build1 [11.6 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-zope.event all 4.4-3 [8180 B]
Get:9 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-zope.component all 4.3.0-3 [38.3 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-certbot all 1.21.0-1build1 [175 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy/universe amd64 certbot all 1.21.0-1build1 [21.3 kB]
Get:12 http://archive.ubuntu.com/ubuntu jammy/universe amd64 python3-certbot-nginx all 1.21.0-1 [35.4 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-icu amd64 2.8.1-0ubuntu2 [540 kB]
Fetched 993 kB in 1s (1169 kB/s)
Preconfiguring packages ...
Selecting previously unselected package python3-josepy.
(Reading database ... 107404 files and directories currently installed.)
Preparing to unpack .../00-python3-josepy_1.10.0-1_all.deb ...
Unpacking python3-josepy (1.10.0-1) ...
Selecting previously unselected package python3-requests-toolbelt.
Preparing to unpack .../01-python3-requests-toolbelt_0.9.1-1_all.deb ...
Unpacking python3-requests-toolbelt (0.9.1-1) ...
Selecting previously unselected package python3-rfc3339.
Preparing to unpack .../02-python3-rfc3339_1.1-3_all.deb ...
Unpacking python3-rfc3339 (1.1-3) ...
Selecting previously unselected package python3-acme.
Preparing to unpack .../03-python3-acme_1.21.0-1ubuntu0.1_all.deb ...
Unpacking python3-acme (1.21.0-1ubuntu0.1) ...
Selecting previously unselected package python3-configargparse.
Preparing to unpack .../04-python3-configargparse_1.5.3-1_all.deb ...
Unpacking python3-configargparse (1.5.3-1) ...
Selecting previously unselected package python3-parsedatetime.
Preparing to unpack .../05-python3-parsedatetime_2.6-2_all.deb ...
Unpacking python3-parsedatetime (2.6-2) ...
Selecting previously unselected package python3-zope.hookable.
Preparing to unpack .../06-python3-zope.hookable_5.1.0-1build1_amd64.deb ...
Unpacking python3-zope.hookable (5.1.0-1build1) ...
Selecting previously unselected package python3-zope.event.
Preparing to unpack .../07-python3-zope.event_4.4-3_all.deb ...
Unpacking python3-zope.event (4.4-3) ...
Selecting previously unselected package python3-zope.component.
Preparing to unpack .../08-python3-zope.component_4.3.0-3_all.deb ...
Unpacking python3-zope.component (4.3.0-3) ...
Selecting previously unselected package python3-certbot.
Preparing to unpack .../09-python3-certbot_1.21.0-1build1_all.deb ...
Unpacking python3-certbot (1.21.0-1build1) ...
Selecting previously unselected package certbot.
Preparing to unpack .../10-certbot_1.21.0-1build1_all.deb ...
Unpacking certbot (1.21.0-1build1) ...
Selecting previously unselected package python3-certbot-nginx.
Preparing to unpack .../11-python3-certbot-nginx_1.21.0-1_all.deb ...
Unpacking python3-certbot-nginx (1.21.0-1) ...
Selecting previously unselected package python3-icu.
Preparing to unpack .../12-python3-icu_2.8.1-0ubuntu2_amd64.deb ...
Unpacking python3-icu (2.8.1-0ubuntu2) ...
Setting up python3-configargparse (1.5.3-1) ...
Setting up python3-requests-toolbelt (0.9.1-1) ...
Setting up python3-parsedatetime (2.6-2) ...
Setting up python3-icu (2.8.1-0ubuntu2) ...
Setting up python3-zope.event (4.4-3) ...
Setting up python3-zope.hookable (5.1.0-1build1) ...
Setting up python3-josepy (1.10.0-1) ...
Setting up python3-rfc3339 (1.1-3) ...
Setting up python3-zope.component (4.3.0-3) ...
Setting up python3-acme (1.21.0-1ubuntu0.1) ...
Setting up python3-certbot (1.21.0-1build1) ...
Setting up certbot (1.21.0-1build1) ...
Created symlink /etc/systemd/system/timers.target.wants/certbot.timer → /lib/systemd/system/certbot.timer.
Setting up python3-certbot-nginx (1.21.0-1) ...
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
root@srv896300:~# certbot --nginx -d excalibur-cuba.de
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Enter email address (used for urgent renewal and security notices)
 (Enter 'c' to cancel): info@excalibur-cuba.com

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please read the Terms of Service at
https://letsencrypt.org/documents/LE-SA-v1.5-February-24-2025.pdf. You must
agree in order to register with the ACME server. Do you agree?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Would you be willing, once your first certificate is successfully issued, to
share your email address with the Electronic Frontier Foundation, a founding
partner of the Let's Encrypt project and the non-profit organization that
develops Certbot? We'd like to send you email about our work encrypting the web,
EFF news, campaigns, and ways to support digital freedom.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y
Account registered.
Requesting a certificate for excalibur-cuba.de

Certbot failed to authenticate some domains (authenticator: nginx). The Certificate Authority reported these problems:
  Domain: excalibur-cuba.de
  Type:   dns
  Detail: DNS problem: NXDOMAIN looking up A for excalibur-cuba.de - check that a DNS record exists for this domain; DNS problem: NXDOMAIN looking up AAAA for excalibur-cuba.de - check that a DNS record exists for this domain

Hint: The Certificate Authority failed to verify the temporary nginx configuration changes made by Certbot. Ensure the listed domains point to this nginx server and that it is accessible from the internet.

Some challenges have failed.
Ask for help or search for solutions at https://community.letsencrypt.org. See the logfile /var/log/letsencrypt/letsencrypt.log or re-run Certbot with -v for more details.
root@srv896300:~# # Self-signed Zertifikat für IP-Adresse
mkdir -p /etc/ssl/private
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
    -keyout /etc/ssl/private/nginx-selfsigned.key \
    -out /etc/ssl/certs/nginx-selfsigned.crt \
    -subj "/C=CU/ST=Havana/L=Havana/O=Excalibur Cuba/CN=31.97.77.135"
.+.+..+.+..+....+.....+.............+........+............+.+......+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*.+....+..+......+.........+.+...+.........+.....+......+................+.....+.........+.+......+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*.......+..+...+......+.+............+...+.....+............+...+....+...+......+..+...+....+.................+.+..+......+.........+..........+.....+............+.........+......+.+.........+...+..+...+...+..........+..+......+.......+..............+......+.......+..+.+.....+.......+...............+...+...+..+.........+......+....+...+...+..+......+....+.....+.............+...+..+....+.....+.........+...............+.......+..+.+......+...........+..........+........+....+.....+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
....+..+.........+.+.................+...+...+....+.....+......+.+........+......+............+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*...+..+....+...+.................+....+.....+......+.+...+......+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*.......+.........+...+........+.......+...+.........+...+......+.....+..........+..+.......+...+..+..........+...+.....+...+.......+..+...+....+........+.+...............+..+..........+..+.+...........+................+..+...+..........+...+..+...+......+......+.......+...........+....+...+..............+.+.........+........+.+......+.....+.+.....+...+.+.....+......+...+..........+..............+...+...+.........+.+......+...+..+..........+.....+.+.........+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-----
root@srv896300:~# # Nginx für HTTPS konfigurieren
cat > /etc/nginx/sites-available/excalibur-cuba << 'EOF'
server {
    listen 80;
    server_name _;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl;
    server_name _;

    ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
    ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
EOF
root@srv896300:~# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
root@srv896300:~# systemctl reload nginx
root@srv896300:~# sudo -u postgres psql excalibur_cuba << 'EOF'
INSERT INTO admin_users (id, username, email, password, first_name, last_name, created_at, updated_at)
VALUES (1, 'excalibur_admin', 'admin@excalibur-cuba.com', '$2b$10$K8pF9Z7oL4N6wM2Q3R8tV.8JzL9M0N1P2Q3R4S5T6U7V8W9X0Y1Z2', 'Admin', 'User', NOW(), NOW());
EOF
could not change directory to "/root": Permission denied
ERROR:  duplicate key value violates unique constraint "admin_users_pkey"
DETAIL:  Key (id)=(1) already exists.
root@srv896300:~# sudo -u postgres psql excalibur_cuba -c "SELECT username, email FROM admin_users;"
could not change directory to "/root": Permission denied
 username |          email
----------+--------------------------
 admin    | admin@excalibur-cuba.com
(1 row)

root@srv896300:~# sudo -u postgres psql excalibur_cuba << 'EOF'
UPDATE admin_users
SET password = '$2b$10$K8pF9Z7oL4N6wM2Q3R8tV.8JzL9M0N1P2Q3R4S5T6U7V8W9X0Y1Z2'
WHERE username = 'admin';
EOF
could not change directory to "/root": Permission denied
UPDATE 1
root@srv896300:~# # Admin-User anzeigen
sudo -u postgres psql excalibur_cuba -c "SELECT username, email FROM admin_users WHERE username = 'admin';"
could not change directory to "/root": Permission denied
 username |          email
----------+--------------------------
 admin    | admin@excalibur-cuba.com
(1 row)

root@srv896300:~# cd /var/www/excalibur-cuba/ExcaliburGenerator
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# node -e "
const bcrypt = require('bcrypt');
const password = 'admin123';
const hash = bcrypt.hashSync(password, 10);
console.log('Hash für admin123:', hash);
"
node:internal/modules/cjs/loader:1215
  throw err;
  ^

Error: Cannot find module 'bcrypt'
Require stack:
- /var/www/excalibur-cuba/ExcaliburGenerator/[eval]
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at [eval]:2:16
    at runScriptInThisContext (node:internal/vm:209:10)
    at node:internal/process/execution:118:14
    at [eval]-wrapper:6:24
    at runScript (node:internal/process/execution:101:62)
    at evalScript (node:internal/process/execution:133:3) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [ '/var/www/excalibur-cuba/ExcaliburGenerator/[eval]' ]
}

Node.js v20.19.3
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# # Mit dem Output vom Node-Befehl:
sudo -u postgres psql excalibur_cuba << 'EOF'
UPDATE admin_users
SET password = 'HIER_DEN_GENERIERTEN_HASH_EINFÜGEN'
WHERE username = 'admin';
EOF
UPDATE 1
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# # Alten User löschen und neuen erstellen
sudo -u postgres psql excalibur_cuba << 'EOF'
DELETE FROM admin_users WHERE username = 'admin';
INSERT INTO admin_users (username, email, password, first_name, last_name)
VALUES ('testadmin', 'test@example.com', '$2b$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'Test', 'Admin');
EOF
DELETE 1
INSERT 0 1
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator#
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# sudo -u postgres psql excalibur_cuba -c "DELETE FROM admin_users;"
DELETE 1
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# sudo -u postgres psql excalibur_cuba -c "\d admin_users"
                                        Table "public.admin_users"
   Column   |            Type             | Collation | Nullable |                 Default
------------+-----------------------------+-----------+----------+-----------------------------------------
 id         | integer                     |           | not null | nextval('admin_users_id_seq'::regclass)
 username   | character varying(50)       |           | not null |
 email      | character varying(100)      |           | not null |
 password   | character varying(255)      |           | not null |
 first_name | character varying(50)       |           |          |
 last_name  | character varying(50)       |           |          |
 role       | character varying(20)       |           |          | 'admin'::character varying
 is_active  | boolean                     |           |          | true
 created_at | timestamp without time zone |           |          | now()
 updated_at | timestamp without time zone |           |          | now()
Indexes:
    "admin_users_pkey" PRIMARY KEY, btree (id)
    "admin_users_email_unique" UNIQUE CONSTRAINT, btree (email)
    "admin_users_username_unique" UNIQUE CONSTRAINT, btree (username)
Referenced by:
    TABLE "uploaded_images" CONSTRAINT "uploaded_images_uploaded_by_admin_users_id_fk" FOREIGN KEY (uploaded_by) REFERENCES admin_users(id)

root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# sudo -u postgres psql excalibur_cuba << 'EOF'
INSERT INTO admin_users (username, email, password, first_name, last_name, role, is_active)
VALUES ('excalibur_admin', 'admin@excalibur-cuba.com', '$2b$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'Admin', 'User', 'admin', true);
EOF
INSERT 0 1
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# sudo -u postgres psql excalibur_cuba -c "SELECT id, username, email, role FROM admin_users;"
 id |    username     |          email           | role
----+-----------------+--------------------------+-------
  3 | excalibur_admin | admin@excalibur-cuba.com | admin
(1 row)

root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# systemctl restart excalibur-cuba
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# systemctl status excalibur-cuba
● excalibur-cuba.service - Excalibur Cuba Website
     Loaded: loaded (/etc/systemd/system/excalibur-cuba.service; enabled; vendor preset: enabled)
     Active: active (running) since Sat 2025-07-05 22:37:39 UTC; 2s ago
   Main PID: 8535 (npm run start)
      Tasks: 23 (limit: 9477)
     Memory: 68.2M
        CPU: 579ms
     CGroup: /system.slice/excalibur-cuba.service
             ├─8535 "npm run start" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
             ├─8547 sh -c "NODE_ENV=production node dist/index.js"
             └─8548 node dist/index.js

Jul 05 22:37:39 srv896300 npm[8548]:   [Symbol(kError)]: Error: self-signed certificate
Jul 05 22:37:39 srv896300 npm[8548]:       at TLSSocket.onConnectSecure (node:_tls_wrap:1677:34)
Jul 05 22:37:39 srv896300 npm[8548]:       at TLSSocket.emit (node:events:524:28)
Jul 05 22:37:39 srv896300 npm[8548]:       at TLSSocket._finishInit (node:_tls_wrap:1076:8)
Jul 05 22:37:39 srv896300 npm[8548]:       at ssl.onhandshakedone (node:_tls_wrap:862:12) {
Jul 05 22:37:39 srv896300 npm[8548]:     code: 'DEPTH_ZERO_SELF_SIGNED_CERT'
Jul 05 22:37:39 srv896300 npm[8548]:   },
Jul 05 22:37:39 srv896300 npm[8548]:   [Symbol(kMessage)]: 'self-signed certificate'
Jul 05 22:37:39 srv896300 npm[8548]: }
Jul 05 22:37:39 srv896300 npm[8548]: 10:37:39 PM [express] serving on port 5000
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# # Zurück zu HTTP-only
cat > /etc/nginx/sites-available/excalibur-cuba << 'EOF'
server {
    listen 80;
    server_name _;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
EOF
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# systemctl reload nginx
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# # HTTPS mit Self-Signed wieder aktivieren
cat > /etc/nginx/sites-available/excalibur-cuba << 'EOF'
server {
    listen 80;
    server_name _;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl;
    server_name _;

    ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
    ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
EOF
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# systemctl reload nginx
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# cd /var/www/excalibur-cuba/ExcaliburGenerator
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# node -e "const bcrypt = require('bcryptjs'); console.log(bcrypt.hashSync('admin123', 10));"
$2b$10$xoya0DE0emU6CaqFw9ejmuayC4nDOlR0NZZIuMVGtKtQRIQRsjb2K
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# sudo -u postgres psql excalibur_cuba << 'EOF'
UPDATE admin_users
SET password = 'HIER_DEN_HASH_VOM_NODE_BEFEHL_EINFÜGEN'
WHERE username = 'excalibur_admin';
EOF
UPDATE 1
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator# systemctl restart excalibur-cuba
root@srv896300:/var/www/excalibur-cuba/ExcaliburGenerator#